#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include "initial_estimate.h"
//COUNT 点 FFT
#define COUNT 4096
//采样频率
#define SRATE 125
//一个时间窗口的 PPG 信号（1000个）
double ppg[COUNT] = { -0.0219044370229491,-0.0213343457972616,-0.0206414933869995,-0.0198614066803061,-0.0190281722917454,-0.0181737175052170,-0.0173271893502324,-0.0165144447739241,-0.0157576615781782,-0.0150750762865066,-0.0144808514829385,-0.0139850715222263,-0.0135938619441227,-0.0133096245290563,-0.0131313767980402,-0.0130551819686525,-0.0130746530046414,-0.0131815125010061,-0.0133661887782623,-0.0136184277537916,-0.0139278999343705,-0.0142847822362425,-0.0146802952758229,-0.0151071782582940,-0.0155600855813207,-0.0160358917116942,-0.0165338937166478,-0.0170559039613368,-0.0176062288337781,-0.0181915328366919,-0.0188205908969544,-0.0195039351915254,-0.0202534060791059,-0.0210816197687928,-0.0220013680664998,-0.0230249678414580,-0.0241635796839440,-0.0254265165291812,-0.0268205637625721,-0.0283493324743738,-0.0300126670893820,-0.0318061275666457,-0.0337205647686982,-0.0357418054772298,-0.0378504609344724,-0.0400218697813702,-0.0422261829204088,-0.0444285942372825,-0.0465897173627697,-0.0486661048400612,-0.0506109022811747,-0.0523746264462611,-0.0539060527558207,-0.0551531946368993,-0.0560643543912937,-0.0565892230279409,-0.0566800047826652,-0.0562925409028503,-0.0553874067346674,-0.0539309562333802,-0.0518962887246750,-0.0492641140630743,-0.0460234942333703,-0.0421724418793431,-0.0377183591642815,-0.0326783037017180,-0.0270790719639912,-0.0209570944944196,-0.0143581413238115,-0.00733684012799982,4.39862367986846e-05,0.00771415221540761,0.0155970977014962,0.0236110140661916,0.0316700872349758,0.0396858343902794,0.0475685088013572,0.0552285457662228,0.0625780217238623,0.0695320982757530,0.0760104231466003,0.0819384610036576,0.0872487285166808,0.0918819100382327,0.0957878327665361,0.0989262831598041,0.101267649632533,0.102793380104205,0.103496246707760,0.103380413814606,0.102461309409429,0.100765303667480,0.0983292022681158,0.0951995654451183,0.0914318669571616,0.0870895099993861,0.0822427195174620,0.0769673323870839,0.0713435084539827,0.0654543864730550,0.0593847095324075,0.0532194446025841,0.0470424204273938,0.0409350070950572,0.0349748593304054,0.0292347438721122,0.0237814692915381,0.0186749343250142,0.0139673082862784,0.00970235445939023,0.00591490460451495,0.00263048989831929,-0.000134869166015864,-0.00237471412387640,-0.00409204394822974,-0.00529905979688971,-0.00601676663227405,-0.00627444128205841,-0.00610897829426329,-0.00556412646016853,-0.00468963012366373,-0.00354029036338620,-0.00217496182749054,-0.000655501428749852,0.000954314716840320,0.00258988978466084,0.00418690412127609,0.00568239693028400,0.00701581682444507,0.00813002709113603,0.00897225242980635,0.00949495493524727,0.00965662819961775,0.00942249957206570,0.00876513183272801,0.00766491679584396,0.00611045464526903,0.00409881411790193,0.00163566998168323,-0.00126468439809794,-0.00457945024917743,-0.00827756180993906,-0.0123200480582905,-0.0166605144386505,-0.0212457398689351,-0.0260163829011539,-0.0309077895043994,-0.0358508935470611,-0.0407731996883547,-0.0455998370631316,-0.0502546708768863,-0.0546614578412315,-0.0587450302977560,-0.0624324929260386,-0.0656544151370394,-0.0683460016441331,-0.0704482233085101,-0.0719088902001849,-0.0726836489248923,-0.0727368866619978,-0.0720425250562478,-0.0705846881186464,-0.0683582296247927,-0.0653691071517058,-0.0616345918581355,-0.0571833053724312,-0.0520550776820017,-0.0463006226869836,-0.0399810310479138,-0.0331670830755910,-0.0259383876269583,-0.0183823562241159,-0.0105930248403432,-0.00266973892998433,0.00528427975073012,0.0131634632463974,0.0208615007038091,0.0282729890707696,0.0352951037366897,0.0418292604786285,0.0477827394132326,0.0530702415430203,0.0576153489474371,0.0613518607158085,0.0642249783487270,0.0661923165513562,0.0672247180781594,0.0673068545221657,0.0664375986190632,0.0646301576915694,0.0619119622166549,0.0583243080724040,0.0539217557205176,0.0487712943075182,0.0429512833223807,0.0365501889296935,0.0296651363062785,0.0224003031502281,0.0148651829156703,0.00717274917390284,-0.000562445257849687,-0.00822619920218492,-0.0157065879345257,-0.0228958457019882,-0.0296921703396657,-0.0360014157310745,-0.0417386399353258,-0.0468294795619122,-0.0512113243608670,-0.0548342699427938,-0.0576618309679033,-0.0596714019522614,-0.0608544579300839,-0.0612164924731504,-0.0607766958877554,-0.0595673816696802,-0.0576331743828892,-0.0550299769260233,-0.0518237395564768,-0.0480890569578212,-0.0439076229765390,-0.0393665753455129,-0.0345567646963899,-0.0295709833989691,-0.0245021902285466,-0.0194417665449494,-0.0144778385810278,-0.00969369861261408,-0.00516635526232342,-0.000965240037875716,0.00284890650198947,0.00622494973582647,0.00912206244707236,0.0115102029006691,0.0133703646125225,0.0146945978842527,0.0154858080844167,0.0157573403746075,0.0155323649986110,0.0148430812773304,0.0137297619941244,0.0122396628396920,0.0104258239519961,0.00834579228983120,0.00606029458985301,0.00363189096457440,0.00112363880847399,-0.00140220438676453,-0.00388541241045075,-0.00626893129492706,-0.00849990805732937,-0.0105305886618999,-0.0123190702404767,-0.0138298964626441,-0.0150344889585088,-0.0159114117646252,-0.0164464697861558,-0.0166326461479096,-0.0164698869508742,-0.0159647452744482,-0.0151298991927379,-0.0139835610425244,-0.0125487971403156,-0.0108527785598410,-0.00892598442775858,-0.00680137946766080,-0.00451358722910939,-0.00209807960237253,0.000409598122592683,0.00297454919345221,0.00556317906559756,0.00814376806509135,0.0106869530792006,0.0131661112535944,0.0155576417049808,0.0178411442882864,0.0199994974055143,0.0220188396302460,0.0238884624745415,0.0256006238788686,0.0271502939053347,0.0285348456155242,0.0297537051842311,0.0308079759195252,0.0317000510211180,0.0324332296190495,0.0330113499120828,0.0334384521004983,0.0337184823227251,0.0338550470104741,0.0338512250317497,0.0337094427605613,0.0334314148658752,0.0330181512221916,0.0324700279822264,0.0317869185888537,0.0309683784053635,0.0300138747712561,0.0289230526990970,0.0276960251615700,0.0263336760121564,0.0248379630624330,0.0232122087170927,0.0214613658461114,0.0195922472421106,0.0176137080488077,0.0155367719219145,0.0133746933557945,0.0111429505281578,0.00885916512472136,0.00654294784448489,0.00421567058896402,0.00190016863861442,-0.000379621649799074,-0.00259908199448794,-0.00473337865607892,-0.00675796503630914,-0.00864910786854246,-0.0103844234438338,-0.0119434096675980,-0.0133079594817290,-0.0144628413248562,-0.0153961328380000,-0.0160995949420202,-0.0165689746943027,-0.0168042269426200,-0.0168096466926547,-0.0165939062431272,-0.0161699934632628,-0.0155550500309818,-0.0147701109529711,-0.0138397491843881,-0.0127916315912516,-0.0116559947893908,-0.0104650514905267,-0.00925233983415186,-0.00805202973540718,-0.00689820149392180,-0.00582411275517227,-0.00486147037243979,-0.00403972377207610,-0.00338539607599488,-0.00292146849182356,-0.00266683236168612,-0.00263582179326076,-0.00283783801830658,-0.00327707457862716,-0.00395235017818420,-0.00485705361860038,-0.00597920271297988,-0.00730161651125852,-0.00880219763105523,-0.0104543190320079,-0.0122273072569751,-0.0140870120443408,-0.0159964503406513,-0.0179165111541073,-0.0198067064216595,-0.0216259521420131,-0.0233333634713009,-0.0248890472960159,-0.0262548759882900,-0.0273952266020628,-0.0282776706667837,-0.0288736009517142,-0.0291587830751315,-0.0291138215790437,-0.0287245320365453,-0.0279822128569198,-0.0268838126516705,-0.0254319912701818,-0.0236350748541117,-0.0215069074436476,-0.0190666037478085,-0.0163382096201347,-0.0133502785202386,-0.0101353737562660,-0.00672950756514758,-0.00317152907524811,0.000497526104510689,0.00423511152062640,0.00799785747799589,0.0117422575293745,0.0154253412215252,0.0190053211720474,0.0224422034822470,0.0256983516203834,0.0287389952026565,0.0315326765201482,0.0340516291708248,0.0362720847182220,0.0381745048745768,0.0397437382593081,0.0409691022794641,0.0418443920856748,0.0423678198475877,0.0425418887432814,0.0423732070489838,0.0418722485347252,0.0410530660095519,0.0399329653128972,0.0385321473177949,0.0368733256026179,0.0349813273709030,0.0328826849672996,0.0306052249685967,0.0281776613415029,0.0256291985745461,0.0229891500324482,0.0202865760703314,0.0175499457046388,0.0148068248892964,0.0120835937095690,0.00940519410044674,0.00679490903704983,0.00427417354454556,0.00186241734457588,-0.000423061498712049,-0.00256719294327084,-0.00455720264640539,-0.00638265246877455,-0.00803545545611617,-0.00950986701807360,-0.0108024540320775,-0.0119120435590997,-0.0128396527783756,-0.0135884016415728,-0.0141634096251266,-0.0145716778339758,-0.0148219575913387,-0.0149246065469321,-0.0148914332581660,-0.0147355311516156,-0.0144711027598374,-0.0141132751537180,-0.0136779075532938,-0.0131813921986410,-0.0126404496933581,-0.0120719201909883,-0.0114925519725775,-0.0109187891533510,-0.0103665604492406,-0.00985107112015556,-0.00938660037676838,-0.00898630668160787,-0.00866204348443294,-0.00842418799803042,-0.00828148563676935,-0.00824091270088804,-0.00830755979066852,-0.00848453827423250,-0.00877291191042902,-0.00917165544585239,-0.00967764166599767,-0.0102856579903053,-0.0109884532664008,-0.0117768149487037,-0.0126396763504845,-0.0135642531470788,-0.0145362077926358,-0.0155398400051573,-0.0165583009863156,-0.0175738285849718,-0.0185680001971445,-0.0195219998301938,-0.0204168954537789,-0.0212339225219342,-0.0219547693849982,-0.0225618602210566,-0.0230386311061399,-0.0233697949109755,-0.0235415908581620,-0.0235420147940068,-0.0233610265191806,-0.0229907308755393,-0.0224255296954844,-0.0216622421765690,-0.0207001917384045,-0.0195412579414770,-0.0181898925881158,-0.0166530996744580,-0.0149403794088976,-0.0130636370477258,-0.0110370578136248,-0.00887694964933366,-0.00660155601008659,-0.00423084130827623,-0.00178625198729749,0.000709543485124745,0.00323293215328810,0.00575964788257035,0.00826507253302769,0.0107245429927558,0.0131136600230140,0.0154085948754079,0.0175863896988061,0.0196252478572948,0.0215048104272019,0.0232064153277733,0.0247133357630857,0.0260109949089359,0.0270871540645220,0.0279320718016868,0.0285386319814127,0.0289024388654426,0.0290218779277541,0.0288981413636811,0.0285352177013034,0.0279398453378548,0.0271214302507420,0.0260919285655318,0.0248656950988856,0.0234592994294680,0.0218913114804883,0.0201820590194404,0.0183533598890100,0.0164282321727543,0.0144305858643367,0.0123848999437420,0.0103158890616521,0.00824816428751558,0.00620589258127044,0.00421245979680917,0.00229014211109313,0.000459790790860801,-0.00125946484558100,-0.00285049154468589,-0.00429839879483291,-0.00559075383661352,-0.00671776114788405,-0.00767240299246664,-0.00845053814286816,-0.00905095647770478,-0.00947538780646716,-0.00972846397889293,-0.00981763408293853,-0.00975303331206727,-0.00954730687589858,-0.00921539112373218,-0.00877425483283393,-0.00824260436694987,-0.00764055711949748,-0.00698928830472588,-0.00631065673393457,-0.00562681569871248,-0.00495981546661120,-0.00433120416594672,-0.00376163398683670,-0.00327047964876570,-0.00287547597713290,-0.00259238119131414,-0.00243467213654105,-0.00241327719602724,-0.00253635200576144,-0.00280910237249457,-0.00323365797849306,-0.00380899955976019,-0.00453094128480709,-0.00539216905750395,-0.00638233444012572,-0.00748820286228337,-0.00869385376918201,-0.00998092938957717,-0.0113289278902549,-0.0127155358490365,-0.0141169942397991,-0.0155084914963667,-0.0168645767205330,-0.0181595857333493,-0.0193680724456183,-0.0204652379475712,-0.0214273497900212,-0.0222321441476271,-0.0228592039138310,-0.0232903062679849,-0.0235097338667772,-0.0235045445303150,-0.0232647951019232,-0.0227837160418652,-0.0220578342493840,-0.0210870425744330,-0.0198746154595400,-0.0184271711228589,-0.0167545816356623,-0.0148698331424099,-0.0127888393017269,-0.0105302117766540,-0.00811499225914723,-0.00556635106627268,-0.00290925778581832,-0.000170129771944787,0.00262353550532216,0.00544353816895765,0.00826135764629390,0.0110485324690299,0.0137770324920457,0.0164196181969488,0.0189501821620076,0.0213440682626695,0.0235783647022102,0.0256321675457260,0.0274868120281486,0.0291260695140456,0.0305363085902594,0.0317066193595596,0.0326289005634934,0.0332979096861504,0.0337112766700806,0.0338694823055074,0.0337758027306177,0.0334362218024146,0.0328593133645973,0.0320560956531187,0.0310398602449568,0.0298259780759931,0.0284316851355143,0.0268758504942226,0.0251787293466340,0.0233617037542411,0.0214470137694551,0.0194574816081280,0.0174162315255474,0.0153464080412392,0.0132708951544499,0.0112120391961284,0.00919137797439699,0.00722937888718236,0.00534518869471022,0.00355639766143115,0.00187882078596758,0.000326298832235702,-0.00108947815226905,-0.00235912220154315,-0.00347567114348207,-0.00443468226126552,-0.00523429369375292,-0.00587525160949067,-0.00636090149372705,-0.00669714225519807,-0.00689234228978149,-0.00695721712967798,-0.00690466885554918,-0.00674958804868830,-0.00650861970217320,-0.00619989518320645,-0.00584273303060150,-0.00545731206697256,-0.00506432098851762,-0.00468458924917212,-0.00433870466254966,-0.00404662368652386,-0.00382728081395766,-0.00369820385225526,-0.00367514211881803,-0.00377171469577041,-0.00399908586452847,-0.00436567467078266,-0.00487690524832926,-0.00553500405447366,-0.00633884954271225,-0.00728387902616499,-0.00836205657770760,-0.00956190478362023,-0.0108686020340756,-0.0122641458164515,-0.0137275811996760,-0.0152352923854066,-0.0167613538824767,-0.0182779365636004,-0.0197557626172734,-0.0211646022424355,-0.0224738038772182,-0.0236528488328166,-0.0246719204437642,-0.0255024772682421,-0.0261178194945867,-0.0264936375468288,-0.0266085319423792,-0.0264444937434677,-0.0259873354601939,-0.0252270630014284,-0.0241581802195264,-0.0227799187401284,-0.0210963870887105,-0.0191166345962047,-0.0168546271582912,-0.0143291336050052,-0.0115635231747228,-0.00858547634322701,-0.00542661299730257,-0.00212204362593108,0.00129014920583455,0.00476949036975264,0.00827374263702865,0.0117595769356626,0.0151832703433440,0.0185014190875784,0.0216716534066483,0.0246533409687411,0.0274082656572546,0.0299012689072814,0.0321008414152096,0.0339796539282335,0.0355150169359914,0.0366892604101636,0.0374900262428549,0.0379104676902168,0.0379493519001300,0.0376110634555088,0.0369055087599246,0.0358479229909936,0.0344585832106335,0.0327624330120465,0.0307886257650636,0.0285699950606839,0.0261424623218804,0.0235443927144439,0.0208159114365874,0.0179981931717896,0.0151327379435907,0.0122606468067013,0.00942191074417787,0.00665472581918093,0.00399484706078877,0.00147499276016182,-0.000875690165721605,-0.00303209029824986,-0.00497351726532732,-0.00668400216922450,-0.00815250797772820,-0.00937304666568092,-0.0103447016396891,-0.0110715557330607,-0.0115625267877895,-0.0118311145136729,-0.0118950639012075,-0.0117759519368400,-0.0114987057013085,-0.0110910611022420,-0.0105829724824364,-0.0100059841406042,-0.00939257539110650,-0.00877549116642068,-0.00818707032802568,-0.00765858379905184,-0.00721959437020785,-0.00689734956743252,-0.00671621831691865,-0.00669718131501217,-0.00685738402393909,-0.00720976008844167,-0.00776273172406082,-0.00851999228716643,-0.00948037482303632,-0.0106378089249767,-0.0119813667484803,-0.0134953975333424,-0.0151597485165829,-0.0169500686921792,-0.0188381905111382,-0.0207925833370888,-0.0227788712965886,-0.0247604071061902,-0.0266988925346326,-0.0285550353809297,-0.0302892322281763,-0.0318622657769828,-0.0332360052777877,-0.0343740984718589,-0.0352426435183196,-0.0358108296284974,-0.0360515355465595,-0.0359418756017711,-0.0354636838056623,-0.0346039273675915,-0.0333550420432861,-0.0317151828995233,-0.0296883853588959,-0.0272846327644789,-0.0245198281564315,-0.0214156694608666,-0.0179994288341687,-0.0143036384606995,-0.0103656866450691,-0.00622732954788898,-0.00193412536197685,0.00246520090970796,0.00691945265611149,0.0113757062947845,0.0157800938221969,0.0200786109519215,0.0242179378987708,0.0281462594543694,0.0318140708027224,0.0351749555519801,0.0381863227160940,0.0408100898688856,0.0430133004106632,0.0447686638271957,0.0460550089716578,0.0468576417469713,0.0471686000895697,0.0469868008329312,0.0463180748335911,0.0451750886439096,0.0435771529820403,0.0415499202455715,0.0391249753048721,0.0363393257580743,0.0332347996945110,0.0298573607605523,0.0262563519157705,0.0224836806749618,0.0185929598224307,0.0146386185323322,0.0106749995102808,0.00675545816920783,0.00293147995424036,-0.000748168269442170,-0.00423823735588024,-0.00749773093667174,-0.0104905628782735,-0.0131861249746169,-0.0155597543129202,-0.0175930915684294,-0.0192743234843674,-0.0205983049388184,-0.0215665582493451,-0.0221871496749645,-0.0224744453980885,-0.0224487515598565,-0.0221358451348428,-0.0215664045205815,-0.0207753506410917,-0.0198011110821756,-0.0186848212542837,-0.0174694777856789,-0.0161990602594519,-0.0149176380037754,-0.0136684789132716,-0.0124931772150283,-0.0114308166970797,-0.0105171851985196,-0.00978405513401360,-0.00925854351295799,-0.00896256334247519,-0.00891237650673754,-0.00911825623027335,-0.00958426510116700,-0.0103081523954766,-0.0112813721526466,-0.0124892211498873,-0.0139110936578974,-0.0155208476761483,-0.0172872752862230,-0.0191746678662544,-0.0211434652141960,-0.0231509761636190,-0.0251521570687583,-0.0271004336056074,-0.0289485506968126,-0.0306494350274065,-0.0321570545771557,-0.0334272598482856,-0.0344185920034097,-0.0350930439308173,-0.0354167613009621,-0.0353606719426568,-0.0349010333199785,-0.0340198894981056,-0.0327054307129659,-0.0309522504691355,-0.0287614969458917,-0.0261409173561257,-0.0231047957415938,-0.0196737864673162,-0.0158746473670229,-0.0117398780627649,-0.00730727041119611,-0.00261937929659991,0.00227707691924417,0.00733187607917628,0.0124920011284694,0.0177023868057208,0.0229066923954202,0.0280480886946330,0.0330700474144413,0.0379171214782244,0.0425357050800421,0.0468747629119377,0.0508865186422612,0.0545270935106539,0.0577570867814191,0.0605420907480722,0.0628531339909695,0.0646670476410432,0.0659667504810286,0.0667414498077709,0.0669867560733852,0.0667047104089173,0.0659037252029281,0.0645984389517277,0.0628094876116608,0.0605631956617574,0.0578911910227960,0.0548299488724539,0.0514202702419573,0.0477067020736101,0.0437369061565161,0.0395609850348714,0.0352307735937864,0.0307991055652177,0.0263190646539012,0.0218432303519217,0.0174229287817816,0.0131074990720162,0.00894358581677425,0.00497446809163385,0.00123943528301754,-0.00222678037039172,-0.00539450513578520,-0.00823955032143470,-0.0107435560911623,-0.0128942456434924,-0.0146855839793207,-0.0161178367685966,-0.0171975262506359,-0.0179372826494782,-0.0183555912363226,-0.0184764369026808,-0.0183288498938415,-0.0179463581624430,-0.0173663536033046,-0.0166293811876482,-0.0157783616902236,-0.0148577602585087,-0.0139127144709418,-0.0129881367338741,-0.0121278068393557,-0.0113734712156953,-0.0107639658216282,-0.0103343797394322,-0.0101152762947928,-0.0101319879605006,-0.0104040003832428,-0.0109444396115653,-0.0117596750102687,-0.0128490484419092,-0.0142047381075828,-0.0158117630023801,-0.0176481312986629,-0.0196851331719668,-0.0218877756848371,-0.0242153544027027,-0.0266221534956968,-0.0290582632457090,-0.0314705011938451,-0.0338034206936607,-0.0360003884410386,-0.0380047106890998,-0.0397607863769510,-0.0412152643480089,-0.0423181812422074,-0.0430240565420607,-0.0432929216502853,-0.0430912607802045,-0.0423928428416480,-0.0411794253849258,-0.0394413139925740,-0.0371777632406862,-0.0343972084361421,-0.0311173207109418,-0.0273648816501067,-0.0231754773685531,-0.0185930157534875,-0.0136690743676450,-0.00846209017950839,-0.00303640576488774,0.00253881017166933,0.00819074725374419,0.0138442197330758,0.0194229895453680,0.0248511196135468,0.0300543300391174,0.0349613295669289,0.0395050950610407,0.0436240726874395,0.0472632760466964,0.0503752586058594,0.0529209404000042,0.0548702720534118,0.0562027226404210,0.0569075816889433,0.0569840696397012,0.0564412552197327,0.0552977823740439,0.0535814135273782,0.0513283999226617,0.0485826935106935,0.0453950182594967 }; //实向量[1, 1, 1, 1, 0, 0, 0, 0]
CPLX buf[COUNT];
double count = 4096;
double srate = 125;
double N_prev;
double Y;


int main()
{
    double M, m;
    CPLX EX[COUNT];
    double EXout[COUNT];
    //int max_;

    double max;
    int size;

    shi2fu(buf, ppg, COUNT);
    //对 buf 完成 COUNT点 的FFT，变换后仍为 buf
    fft(buf, COUNT);

    M = srate * 60 / count;
    m = floor(242 / M);
    //printf("%f\n", m);
    //printf("%f\n", 242/m);
    //printf("%f\n", floor (242 / m));
    for (int i = 0; i < m; i++)
    {
        EX[i].real = buf[i].real;
        EX[i].image = buf[i].image;
        //printf("%d: ", i + 1);
        //if (buf[i].image >= 0.0)
        //{
        //    printf("%.4f + %.4fi\n", buf[i].real, buf[i].image);
        //}
        //else
        //{
        //    printf("%.4f - %.4fi\n", buf[i].real, fabs(buf[i].image));
        //}
    }


    c_abs(EX, EXout, m);//复数数组取模，数组 EXout 为取模后的结果
    for (int i = 0; i < m; i++)
    {
        printf("%d: ", i + 1);
        printf("%.4f\n", EXout[i]);
    }

    N_prev = findmax(EXout, m);
    Y = (N_prev - 1) * M;
    printf("%f\n", N_prev);
    printf("%f\n", Y);


    //打印复数
    //for (int i = 0; i < COUNT; i++)
    //{
    //    printf("%d: ", i+1);
    //    if (buf[i].image >= 0.0)
    //    {
    //        printf("%.4f + %.4fi\n", buf[i].real, buf[i].image);
    //    }
    //    else
    //    {
    //        printf("%.4f - %.4fi\n", buf[i].real, fabs(buf[i].image));
    //    }
    //}
   
    return 0;
}