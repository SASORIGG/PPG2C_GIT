#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include "initial_estimate.h"
//#include "data_preprocess.h"
//COUNT 点 FFT
#define COUNT 4096
//采样频率
#define SRATE 125
double PPG1[COUNT] = { -23,-24,-26.5000000000000,-27,-30,-30,-28.5000000000000,-28,-29,-29,-27,-24.5000000000000,-23.5000000000000,-23,-21.5000000000000,-19,-17.5000000000000,-17.5000000000000,-15,-16,-14,-13.5000000000000,-14,-13,-14,-14.5000000000000,-15.5000000000000,-16.5000000000000,-18,-20.5000000000000,-19.5000000000000,-20,-23.5000000000000,-24,-26,-25.5000000000000,-26,-28,-29.5000000000000,-31,-30.5000000000000,-31.5000000000000,-34,-36,-37.5000000000000,-38,-39,-41,-41,-42,-41.5000000000000,-41,-41.5000000000000,-40.5000000000000,-40,-36.5000000000000,-37,-34.5000000000000,-33.5000000000000,-31.5000000000000,-28.5000000000000,-27.5000000000000,-27,-25.5000000000000,-25,-22.5000000000000,-21.5000000000000,-20.5000000000000,-17,-15,-11,-8.50000000000000,-5,0,5.50000000000000,11.5000000000000,18.5000000000000,24.5000000000000,31,38.5000000000000,44,50.5000000000000,55.5000000000000,58,61,62.5000000000000,65.5000000000000,65,63.5000000000000,63,63,62,59,57.5000000000000,54.5000000000000,54,51.5000000000000,47.5000000000000,45,41,38.5000000000000,34.5000000000000,31.5000000000000,28.5000000000000,24.5000000000000,21,16.5000000000000,14.5000000000000,12,7,7,3.50000000000000,1.50000000000000,0.500000000000000,-1,-1,-1,-0.500000000000000,-1.50000000000000,-1,-0.500000000000000,-0.500000000000000,-0.500000000000000,0,-2,0,-2,-2.50000000000000,-2,-3.50000000000000,-3,-4,-3.50000000000000,-4.50000000000000,-7,-6.50000000000000,-8,-9.50000000000000,-11,-13.5000000000000,-14,-15.5000000000000,-18,-19,-19.5000000000000,-21.5000000000000,-22,-23.5000000000000,-24,-24.5000000000000,-25.5000000000000,-24.5000000000000,-24.5000000000000,-24.5000000000000,-24,-24,-22.5000000000000,-22,-20,-21,-19,-18,-17,-16,-16,-15,-15,-14.5000000000000,-15,-15,-14,-13,-11,-7.50000000000000,-4.50000000000000,0.500000000000000,6,8.50000000000000,13.5000000000000,17.5000000000000,21.5000000000000,25,27,29,28.5000000000000,30.5000000000000,31.5000000000000,29.5000000000000,29,25,24.5000000000000,21.5000000000000,18.5000000000000,15,11,8,5,0.500000000000000,-3,-6.50000000000000,-8.50000000000000,-11,-13.5000000000000,-15.5000000000000,-15.5000000000000,-17,-19,-20,-19.5000000000000,-20,-18,-18.5000000000000,-17.5000000000000,-16.5000000000000,-15.5000000000000,-12,-10.5000000000000,-10,-9,-9,-6,-5,-5.50000000000000,-4.50000000000000,-5.50000000000000,-3,-3.50000000000000,-4.50000000000000,-5.50000000000000,-5,-4.50000000000000,-7,-7.50000000000000,-9,-9.50000000000000,-9,-11,-13.5000000000000,-15,-16,-17,-19,-20.5000000000000,-21,-22.5000000000000,-20.5000000000000,-21,-22,-20,-21,-20.5000000000000,-19,-20,-19.5000000000000,-20.5000000000000,-18.5000000000000,-19,-20,-18.5000000000000,-20,-20,-19.5000000000000,-20.5000000000000,-20,-21,-21.5000000000000,-22,-22,-22.5000000000000,-23.5000000000000,-23.5000000000000,-24.5000000000000,-24.5000000000000,-25.5000000000000,-25.5000000000000,-25,-23,-22,-19.5000000000000,-16.5000000000000,-12,-9,-4.50000000000000,0,1.50000000000000,5.50000000000000,8,10.5000000000000,10,12,14.5000000000000,13.5000000000000,11.5000000000000,12.5000000000000,10,9.50000000000000,8.50000000000000,6,3.50000000000000,1,0,-3.50000000000000,-6,-9,-10,-11.5000000000000,-14.5000000000000,-16,-17,-19,-18.5000000000000,-20.5000000000000,-22.5000000000000,-23.5000000000000,-23.5000000000000,-22,-23.5000000000000,-25,-24.5000000000000,-24.5000000000000,-23,-22.5000000000000,-23.5000000000000,-22.5000000000000,-22.5000000000000,-22.5000000000000,-22.5000000000000,-22,-21.5000000000000,-22,-21.5000000000000,-21.5000000000000,-23,-22,-21.5000000000000,-21,-22,-25.5000000000000,-20.5000000000000,-22,-21.5000000000000,-20.5000000000000,-21,-21,-21,-20,-20.5000000000000,-22,-26,-22.5000000000000,-22.5000000000000,-22,-27.5000000000000,-23.5000000000000,-26,-25,-23.5000000000000,-25,-25,-26,-25.5000000000000,-25.5000000000000,-25.5000000000000,-30,-27.5000000000000,-27,-27.5000000000000,-27.5000000000000,-28,-29.5000000000000,-28.5000000000000,-29,-30,-29.5000000000000,-31,-28,-27,-28,-28,-26,-23.5000000000000,-21.5000000000000,-25,-17,-14.5000000000000,-9.50000000000000,-6.50000000000000,-2,2,6,9.50000000000000,13,15,16,19,21,21,21,22,19.5000000000000,19,18,15,13.5000000000000,9.50000000000000,9,5,3.50000000000000,0.500000000000000,-1,-2,-3,-7,-6.50000000000000,-8.50000000000000,-9,-9,-8.50000000000000,-9.50000000000000,-10.5000000000000,-10,-9,-9,-10.5000000000000,-10,-9,-10,-10.5000000000000,-10.5000000000000,-12,-10.5000000000000,-11.5000000000000,-12.5000000000000,-12.5000000000000,-13,-11.5000000000000,-12,-14,-13.5000000000000,-14,-13.5000000000000,-14,-14.5000000000000,-14,-15,-15.5000000000000,-15.5000000000000,-15.5000000000000,-17,-17,-16.5000000000000,-15.5000000000000,-16,-16.5000000000000,-17.5000000000000,-16.5000000000000,-16.5000000000000,-16,-18,-18,-18,-17.5000000000000,-18,-19.5000000000000,-20.5000000000000,-20,-19.5000000000000,-19.5000000000000,-21,-21,-21,-21.5000000000000,-22,-23,-23,-22,-21,-21.5000000000000,-20.5000000000000,-21,-20.5000000000000,-20.5000000000000,-21.5000000000000,-21,-20.5000000000000,-20,-19,-18,-15,-12,-10,-6.50000000000000,-3.50000000000000,2,4,8.50000000000000,13,16,17.5000000000000,21,22,23.5000000000000,22.5000000000000,23.5000000000000,22.5000000000000,21.5000000000000,20.5000000000000,19,17.5000000000000,14.5000000000000,13,10.5000000000000,8.50000000000000,7,5.50000000000000,3,2,1,1,-1.50000000000000,-2.50000000000000,-3,-3.50000000000000,-4.50000000000000,-6,-7,-6,-6.50000000000000,-7.50000000000000,-6.50000000000000,-6.50000000000000,-6.50000000000000,-7.50000000000000,-5.50000000000000,-5.50000000000000,-6.50000000000000,-7,-6.50000000000000,-6,-6,-5.50000000000000,-5.50000000000000,-6.50000000000000,-9,-8.50000000000000,-8,-10,-11,-11,-12,-12.5000000000000,-13,-13.5000000000000,-13,-13,-13,-13,-16,-13.5000000000000,-13.5000000000000,-13.5000000000000,-14.5000000000000,-14,-13,-13,-13,-14.5000000000000,-14,-15,-16,-16.5000000000000,-16.5000000000000,-17.5000000000000,-17.5000000000000,-17.5000000000000,-15.5000000000000,-17,-18,-17,-17.5000000000000,-16.5000000000000,-18.5000000000000,-18.5000000000000,-18.5000000000000,-18.5000000000000,-17.5000000000000,-17,-17.5000000000000,-17.5000000000000,-15,-13,-12,-10.5000000000000,-7,-4,0,3,7.50000000000000,10.5000000000000,13.5000000000000,18.5000000000000,21.5000000000000,23,23,26,27,28.5000000000000,26.5000000000000,26,26,24.5000000000000,22,19,16,14,12.5000000000000,11,7.50000000000000,4.50000000000000,3,2,1,-2,-4,-6,-5,-6,-6,-7.50000000000000,-8.50000000000000,-6,-6,-5,-5,-5.50000000000000,-5,-4.50000000000000,-5.50000000000000,-6.50000000000000,-6.50000000000000,-6,-6,-7,-7,-7.50000000000000,-7.50000000000000,-7.50000000000000,-8.50000000000000,-10,-10,-10,-9.50000000000000,-13,-12,-12,-13,-12.5000000000000,-14,-15.5000000000000,-15.5000000000000,-15,-15,-14,-13.5000000000000,-13.5000000000000,-14,-14,-15,-15,-16,-15.5000000000000,-15.5000000000000,-15.5000000000000,-15,-14.5000000000000,-16.5000000000000,-16,-16.5000000000000,-18,-18,-19.5000000000000,-18.5000000000000,-21,-20.5000000000000,-20,-19.5000000000000,-18.5000000000000,-18,-17.5000000000000,-15.5000000000000,-11,-9,-6.50000000000000,-2.50000000000000,3.50000000000000,8,12,16.5000000000000,19,23,26,29.5000000000000,32,33.5000000000000,33,34,34.5000000000000,33,31,30,28,25.5000000000000,22,20,16.5000000000000,14,12.5000000000000,10,8.50000000000000,6.50000000000000,5,3.50000000000000,2.50000000000000,1.50000000000000,2,0.500000000000000,0.500000000000000,0,0,-0.500000000000000,-0.500000000000000,0.500000000000000,1,0.500000000000000,1,0.500000000000000,0.500000000000000,0,0,2,1,0,0,-1,-1.50000000000000,-2,-1.50000000000000,-4,-5,-5,-5.50000000000000,-5.50000000000000,-6.50000000000000,-6.50000000000000,-7,-7,-6.50000000000000,-7.50000000000000,-7,-8.50000000000000,-9,-9.50000000000000,-11,-11,-11.5000000000000,-11,-11.5000000000000,-12,-12,-11.5000000000000,-11,-11,-11,-9,-11,-11.5000000000000,-10.5000000000000,-12.5000000000000,-10.5000000000000,-10.5000000000000,-11.5000000000000,-10,-10.5000000000000,-9,-6,-2,1.50000000000000,5,11.5000000000000,16,21,26.5000000000000,32.5000000000000,36,41,43.5000000000000,46.5000000000000,49,47,48.5000000000000,48.5000000000000,48.5000000000000,45.5000000000000,42.5000000000000,41,38,35.5000000000000,32,27,24.5000000000000,22,20,16,13,13,11,10,8.50000000000000,5,6.50000000000000,5,5,4.50000000000000,4,4.50000000000000,3.50000000000000,3.50000000000000,3.50000000000000,3,2.50000000000000,3,3.50000000000000,2.50000000000000,2.50000000000000,2.50000000000000,2,2,1,0,-1.50000000000000,-2,-2.50000000000000,-5,-6.50000000000000,-6.50000000000000,-6,-7,-7.50000000000000,-8.50000000000000,-9,-8.50000000000000,-10,-10.5000000000000,-10.5000000000000,-10.5000000000000,-11,-11,-12,-11.5000000000000,-12.5000000000000,-13,-12,-12.5000000000000,-11,-12,-12.5000000000000,-12.5000000000000,-14.5000000000000,-13.5000000000000,-13,-14.5000000000000,-14.5000000000000,-15.5000000000000,-14.5000000000000,-14,-14.5000000000000,-14.5000000000000,-14.5000000000000,-13.5000000000000,-12,-9.50000000000000,-6.50000000000000,-2.50000000000000,2,7.50000000000000,12.5000000000000,17.5000000000000,22.5000000000000,27,32,34.5000000000000,37,38,40,40,38.5000000000000,37.5000000000000,37,32,30.5000000000000,27,24,21.5000000000000,17,13,10.5000000000000,7.50000000000000,4,2,-1,-3,-4.50000000000000,-7.50000000000000,-9.50000000000000,-9.50000000000000,-10.5000000000000,-11,-11.5000000000000,-13,-13,-12.5000000000000,-13,-13,-12.5000000000000,-13,-12.5000000000000,-12.5000000000000,-14,-13,-14,-14,-13,-13.5000000000000,-13,-14.5000000000000,-15,-14,-14.5000000000000,-13.5000000000000,-15,-15,-14.5000000000000,-15.5000000000000,-18.5000000000000,-16,-15.5000000000000,-16.5000000000000,-17,-18,-18.5000000000000,-19,-20.5000000000000,-19.5000000000000,-22.5000000000000,-23,-23,-24,-25,-25.5000000000000,-26.5000000000000,-26.5000000000000,-25,-26.5000000000000,-25.5000000000000,-25,-24.5000000000000,-24.5000000000000,-24.5000000000000,-23,-22,-21,-20.5000000000000,-20,-19.5000000000000,-19,-19,-18,-16,-13,-11.5000000000000,-8.50000000000000,-4.50000000000000,-2,1.50000000000000,7,11,15,17.5000000000000,21.5000000000000,25.5000000000000,28,31,32.5000000000000,34,34.5000000000000,34.5000000000000,35,33.5000000000000,33,31.5000000000000 };
double PPG2[COUNT] = { 4,6,3,3.50000000000000,0,2,3,3.50000000000000,3,3,5.50000000000000,6.50000000000000,7.50000000000000,7.50000000000000,7,7,8.50000000000000,7.50000000000000,7,6.50000000000000,6.50000000000000,6.50000000000000,5.50000000000000,7.50000000000000,6,7.50000000000000,7,6.50000000000000,5.50000000000000,2.50000000000000,4,3,1.50000000000000,-0.500000000000000,-2.50000000000000,-3,-4,-5.50000000000000,-6.50000000000000,-8.50000000000000,-8,-9.50000000000000,-12,-12.5000000000000,-14,-14.5000000000000,-14.5000000000000,-17,-17,-17.5000000000000,-17,-18.5000000000000,-20.5000000000000,-21.5000000000000,-24,-23,-23.5000000000000,-23.5000000000000,-22.5000000000000,-23.5000000000000,-22.5000000000000,-21,-20,-19,-18.5000000000000,-16.5000000000000,-15.5000000000000,-15,-12,-11.5000000000000,-8,-5,-2.50000000000000,1.50000000000000,7,11.5000000000000,18,24,30.5000000000000,35.5000000000000,42,47,51.5000000000000,54,55.5000000000000,59,61.5000000000000,60.5000000000000,58.5000000000000,56.5000000000000,55,51.5000000000000,47,44.5000000000000,38.5000000000000,36.5000000000000,32,25.5000000000000,21.5000000000000,14.5000000000000,11.5000000000000,8,2.50000000000000,-1.50000000000000,-7,-9.50000000000000,-14.5000000000000,-15.5000000000000,-18,-19.5000000000000,-20,-20.5000000000000,-20.5000000000000,-18.5000000000000,-18.5000000000000,-16.5000000000000,-14.5000000000000,-13.5000000000000,-11,-11.5000000000000,-8,-7,-5,-4,-4.50000000000000,-2,-2,-2.50000000000000,-3,-4.50000000000000,-3.50000000000000,-4,-5.50000000000000,-6,-9.50000000000000,-11,-12.5000000000000,-13.5000000000000,-17,-18.5000000000000,-20.5000000000000,-24,-26,-29.5000000000000,-34,-36,-38.5000000000000,-42,-44.5000000000000,-50.5000000000000,-52.5000000000000,-56,-59.5000000000000,-63.5000000000000,-66.5000000000000,-68.5000000000000,-71,-73,-76,-77,-77,-79,-79,-79.5000000000000,-80.5000000000000,-79,-77.5000000000000,-77.5000000000000,-76,-74.5000000000000,-69,-64.5000000000000,-58.5000000000000,-51.5000000000000,-44.5000000000000,-33.5000000000000,-22.5000000000000,-12.5000000000000,-3,5.50000000000000,17,24,30,34,37.5000000000000,40.5000000000000,41.5000000000000,40.5000000000000,37.5000000000000,34,29,24.5000000000000,18,10.5000000000000,4,-3,-10,-18.5000000000000,-25.5000000000000,-32.5000000000000,-38,-45,-51,-56.5000000000000,-61.5000000000000,-67,-72.5000000000000,-77,-79,-81.5000000000000,-84,-86.5000000000000,-88.5000000000000,-90.5000000000000,-90.5000000000000,-90,-89.5000000000000,-90.5000000000000,-89,-87,-85,-81.5000000000000,-77,-71.5000000000000,-65,-59,-53,-45.5000000000000,-40,-32.5000000000000,-26.5000000000000,-22,-17,-13.5000000000000,-10.5000000000000,-6,-5,-3.50000000000000,-3.50000000000000,-5,-6,-6.50000000000000,-9.50000000000000,-13.5000000000000,-18.5000000000000,-21,-24,-28.5000000000000,-31.5000000000000,-36,-37,-38.5000000000000,-40.5000000000000,-41.5000000000000,-42,-41,-39,-37,-33.5000000000000,-33,-29,-24.5000000000000,-22,-18,-15.5000000000000,-11.5000000000000,-9.50000000000000,-8,-7.50000000000000,-8,-6.50000000000000,-6.50000000000000,-7.50000000000000,-10,-10,-11,-11,-12.5000000000000,-14,-14,-12.5000000000000,-12.5000000000000,-11.5000000000000,-13,-12,-11,-10,-8.50000000000000,-9,-6,-3.50000000000000,-1.50000000000000,-1,1,1,1.50000000000000,2,1.50000000000000,0.500000000000000,-1,-3,-6,-8.50000000000000,-13,-14,-16.5000000000000,-20,-22.5000000000000,-24,-27,-29,-30,-30,-30.5000000000000,-30.5000000000000,-31,-30.5000000000000,-31,-30,-29.5000000000000,-27.5000000000000,-27.5000000000000,-26.5000000000000,-26,-24.5000000000000,-24.5000000000000,-24.5000000000000,-23.5000000000000,-23,-22,-21.5000000000000,-21.5000000000000,-22.5000000000000,-22.5000000000000,-23,-25.5000000000000,-26.5000000000000,-27.5000000000000,-27,-28.5000000000000,-28.5000000000000,-28.5000000000000,-28,-28,-28,-28.5000000000000,-27.5000000000000,-27.5000000000000,-28.5000000000000,-27.5000000000000,-27.5000000000000,-26.5000000000000,-27.5000000000000,-25.5000000000000,-27,-25.5000000000000,-26,-27,-28,-29.5000000000000,-27.5000000000000,-27.5000000000000,-28.5000000000000,-30.5000000000000,-30,-28.5000000000000,-28.5000000000000,-27.5000000000000,-27,-27,-23.5000000000000,-22.5000000000000,-22.5000000000000,-22,-21,-19.5000000000000,-18.5000000000000,-18.5000000000000,-16.5000000000000,-15,-14.5000000000000,-11.5000000000000,-11,-8,-5,-2,0.500000000000000,3.50000000000000,6.50000000000000,8.50000000000000,10,13,14,14.5000000000000,17,17,18.5000000000000,18.5000000000000,19.5000000000000,17.5000000000000,15.5000000000000,14.5000000000000,12,8.50000000000000,5.50000000000000,2,0,-3.50000000000000,-6,-10,-11.5000000000000,-13.5000000000000,-15.5000000000000,-18,-19,-21,-20.5000000000000,-22,-22,-22,-21,-21.5000000000000,-20,-19,-19.5000000000000,-18,-17.5000000000000,-18,-17,-18,-17,-15.5000000000000,-16,-14,-14.5000000000000,-14.5000000000000,-13,-14.5000000000000,-15.5000000000000,-14.5000000000000,-15,-15,-16,-16,-15.5000000000000,-15.5000000000000,-15.5000000000000,-17,-18,-17.5000000000000,-17.5000000000000,-16,-15,-17,-15,-14,-12.5000000000000,-14.5000000000000,-11.5000000000000,-10.5000000000000,-9.50000000000000,-8.50000000000000,-8,-9,-10,-10,-9.50000000000000,-9.50000000000000,-13,-9.50000000000000,-9.50000000000000,-9.50000000000000,-12,-12,-10.5000000000000,-9.50000000000000,-9,-9.50000000000000,-9,-9,-10,-10,-10,-10,-9.50000000000000,-10,-9.50000000000000,-10.5000000000000,-8.50000000000000,-6.50000000000000,-5.50000000000000,-3,-1,1,2.50000000000000,5.50000000000000,7,9,11,12.5000000000000,12.5000000000000,13.5000000000000,11.5000000000000,13.5000000000000,13.5000000000000,12.5000000000000,11.5000000000000,11,9.50000000000000,7.50000000000000,6,4.50000000000000,2.50000000000000,0.500000000000000,0.500000000000000,-1.50000000000000,-1,-4.50000000000000,-4,-4.50000000000000,-5.50000000000000,-7,-6.50000000000000,-7,-7.50000000000000,-8.50000000000000,-8.50000000000000,-8.50000000000000,-10,-8.50000000000000,-8,-7,-8.50000000000000,-6.50000000000000,-5.50000000000000,-6,-5,-5,-3.50000000000000,-3,-4,-3.50000000000000,-4.50000000000000,-5,-5,-4,-3.50000000000000,-5.50000000000000,-5.50000000000000,-6,-6,-7,-8,-8.50000000000000,-8.50000000000000,-9.50000000000000,-9,-11,-9,-8,-7.50000000000000,-7,-8,-8.50000000000000,-8.50000000000000,-9,-9,-9,-9.50000000000000,-10,-10,-10,-10.5000000000000,-11,-11,-10.5000000000000,-10.5000000000000,-11.5000000000000,-10.5000000000000,-12,-12.5000000000000,-12,-13,-13.5000000000000,-13.5000000000000,-14,-13,-13,-14,-12.5000000000000,-11,-9.50000000000000,-10,-6.50000000000000,-4.50000000000000,-0.500000000000000,1,3,5.50000000000000,6.50000000000000,10,11,12,13,14,16,16.5000000000000,14,13,12.5000000000000,11.5000000000000,9.50000000000000,7.50000000000000,7,5.50000000000000,5,4.50000000000000,3,1.50000000000000,0.500000000000000,1,0.500000000000000,-1,-2.50000000000000,-3.50000000000000,-3,-3,-3.50000000000000,-5,-4.50000000000000,-3.50000000000000,-1,-2,-1,-1.50000000000000,-0.500000000000000,1,-1,-3,-2,-2.50000000000000,-1.50000000000000,-3,-2.50000000000000,-3,-4,-4,-5,-6.50000000000000,-5.50000000000000,-6.50000000000000,-5.50000000000000,-9.50000000000000,-6.50000000000000,-6.50000000000000,-8,-8,-9,-12,-10.5000000000000,-10,-9,-8.50000000000000,-7.50000000000000,-7.50000000000000,-5.50000000000000,-6.50000000000000,-7,-6,-7,-7,-7,-7,-8.50000000000000,-8,-8.50000000000000,-9,-10,-10,-10.5000000000000,-11,-11,-12.5000000000000,-11,-11,-11,-10,-10,-8.50000000000000,-8,-6.50000000000000,-4.50000000000000,-4.50000000000000,-3,3,4.50000000000000,7,8.50000000000000,10.5000000000000,13,15.5000000000000,16,18,19,21,19.5000000000000,20.5000000000000,20.5000000000000,21.5000000000000,20.5000000000000,19.5000000000000,18.5000000000000,16,15,12,10,8,6,4.50000000000000,2.50000000000000,1,0.500000000000000,-0.500000000000000,-1,-1.50000000000000,-1.50000000000000,-1.50000000000000,-2,-1.50000000000000,-1.50000000000000,-1.50000000000000,-1,-1,0,0.500000000000000,-0.500000000000000,0.500000000000000,1,1,2,1.50000000000000,2,1.50000000000000,1,1,-0.500000000000000,0,-1,-2,-2.50000000000000,-1,-0.500000000000000,-1.50000000000000,-1,0,-0.500000000000000,-0.500000000000000,-1,-0.500000000000000,-1.50000000000000,-1.50000000000000,-2.50000000000000,-3.50000000000000,-5.50000000000000,-6,-6,-6.50000000000000,-7,-6.50000000000000,-6.50000000000000,-6,-6.50000000000000,-8,-6,-5.50000000000000,-6.50000000000000,-5,-6,-6,-4.50000000000000,-5,-4,-4.50000000000000,-2,-0.500000000000000,1.50000000000000,3,4.50000000000000,10.5000000000000,13.5000000000000,17,21,24.5000000000000,26,30.5000000000000,33,35.5000000000000,36.5000000000000,36,38.5000000000000,40,41,39.5000000000000,36.5000000000000,36.5000000000000,34,33.5000000000000,30.5000000000000,26,26,23.5000000000000,21.5000000000000,18,14.5000000000000,15,12.5000000000000,11,8,4.50000000000000,5.50000000000000,4.50000000000000,4,4.50000000000000,5,5.50000000000000,5.50000000000000,6.50000000000000,6,5,6,6.50000000000000,7,7.50000000000000,7.50000000000000,7,8,9,9.50000000000000,9,8.50000000000000,8,8.50000000000000,8,6.50000000000000,8,9.50000000000000,11,9.50000000000000,12,13.5000000000000,14,15,15.5000000000000,16,15.5000000000000,15.5000000000000,14,15,13.5000000000000,14.5000000000000,13.5000000000000,13.5000000000000,11,14,15,13.5000000000000,14.5000000000000,14,14,14,10.5000000000000,10.5000000000000,10,9,9.50000000000000,9,8,6.50000000000000,8.50000000000000,10.5000000000000,13,17,21,24.5000000000000,31.5000000000000,37.5000000000000,44,49.5000000000000,57,63.5000000000000,67.5000000000000,74.5000000000000,76,82,84.5000000000000,83,86,85.5000000000000,83,82,81.5000000000000,79.5000000000000,77.5000000000000,74,72,70,67,64,60.5000000000000,58,55,53,50.5000000000000,48,46.5000000000000,44.5000000000000,42,41,38.5000000000000,38,36.5000000000000,35,33,32.5000000000000,32,29.5000000000000,27.5000000000000,25.5000000000000,24,22,21.5000000000000,21,20,19.5000000000000,20,18.5000000000000,18.5000000000000,17.5000000000000,18.5000000000000,18,17.5000000000000,17.5000000000000,17,16.5000000000000,15.5000000000000,15.5000000000000,15,13.5000000000000,13,11.5000000000000,9.50000000000000,9,8.50000000000000,7,6.50000000000000,6,5,5,6,4.50000000000000,4.50000000000000,4.50000000000000,5.50000000000000,6,6.50000000000000,7.50000000000000,7,7,7,7,6,6,5,5,4,2.50000000000000,3.50000000000000,4.50000000000000,6.50000000000000,8.50000000000000,11.5000000000000,16.5000000000000,21.5000000000000,26.5000000000000,33.5000000000000,39.5000000000000,45.5000000000000,51.5000000000000,58,64,67.5000000000000,72,76,79.5000000000000,81.5000000000000,80,82.5000000000000,82,79.5000000000000,77 };
//一个时间窗口的 PPG 信号（1000个）
double PPG_final[COUNT] = { -0.0219044370229491,-0.0213343457972616,-0.0206414933869995,-0.0198614066803061,-0.0190281722917454,-0.0181737175052170,-0.0173271893502324,-0.0165144447739241,-0.0157576615781782,-0.0150750762865066,-0.0144808514829385,-0.0139850715222263,-0.0135938619441227,-0.0133096245290563,-0.0131313767980402,-0.0130551819686525,-0.0130746530046414,-0.0131815125010061,-0.0133661887782623,-0.0136184277537916,-0.0139278999343705,-0.0142847822362425,-0.0146802952758229,-0.0151071782582940,-0.0155600855813207,-0.0160358917116942,-0.0165338937166478,-0.0170559039613368,-0.0176062288337781,-0.0181915328366919,-0.0188205908969544,-0.0195039351915254,-0.0202534060791059,-0.0210816197687928,-0.0220013680664998,-0.0230249678414580,-0.0241635796839440,-0.0254265165291812,-0.0268205637625721,-0.0283493324743738,-0.0300126670893820,-0.0318061275666457,-0.0337205647686982,-0.0357418054772298,-0.0378504609344724,-0.0400218697813702,-0.0422261829204088,-0.0444285942372825,-0.0465897173627697,-0.0486661048400612,-0.0506109022811747,-0.0523746264462611,-0.0539060527558207,-0.0551531946368993,-0.0560643543912937,-0.0565892230279409,-0.0566800047826652,-0.0562925409028503,-0.0553874067346674,-0.0539309562333802,-0.0518962887246750,-0.0492641140630743,-0.0460234942333703,-0.0421724418793431,-0.0377183591642815,-0.0326783037017180,-0.0270790719639912,-0.0209570944944196,-0.0143581413238115,-0.00733684012799982,4.39862367986846e-05,0.00771415221540761,0.0155970977014962,0.0236110140661916,0.0316700872349758,0.0396858343902794,0.0475685088013572,0.0552285457662228,0.0625780217238623,0.0695320982757530,0.0760104231466003,0.0819384610036576,0.0872487285166808,0.0918819100382327,0.0957878327665361,0.0989262831598041,0.101267649632533,0.102793380104205,0.103496246707760,0.103380413814606,0.102461309409429,0.100765303667480,0.0983292022681158,0.0951995654451183,0.0914318669571616,0.0870895099993861,0.0822427195174620,0.0769673323870839,0.0713435084539827,0.0654543864730550,0.0593847095324075,0.0532194446025841,0.0470424204273938,0.0409350070950572,0.0349748593304054,0.0292347438721122,0.0237814692915381,0.0186749343250142,0.0139673082862784,0.00970235445939023,0.00591490460451495,0.00263048989831929,-0.000134869166015864,-0.00237471412387640,-0.00409204394822974,-0.00529905979688971,-0.00601676663227405,-0.00627444128205841,-0.00610897829426329,-0.00556412646016853,-0.00468963012366373,-0.00354029036338620,-0.00217496182749054,-0.000655501428749852,0.000954314716840320,0.00258988978466084,0.00418690412127609,0.00568239693028400,0.00701581682444507,0.00813002709113603,0.00897225242980635,0.00949495493524727,0.00965662819961775,0.00942249957206570,0.00876513183272801,0.00766491679584396,0.00611045464526903,0.00409881411790193,0.00163566998168323,-0.00126468439809794,-0.00457945024917743,-0.00827756180993906,-0.0123200480582905,-0.0166605144386505,-0.0212457398689351,-0.0260163829011539,-0.0309077895043994,-0.0358508935470611,-0.0407731996883547,-0.0455998370631316,-0.0502546708768863,-0.0546614578412315,-0.0587450302977560,-0.0624324929260386,-0.0656544151370394,-0.0683460016441331,-0.0704482233085101,-0.0719088902001849,-0.0726836489248923,-0.0727368866619978,-0.0720425250562478,-0.0705846881186464,-0.0683582296247927,-0.0653691071517058,-0.0616345918581355,-0.0571833053724312,-0.0520550776820017,-0.0463006226869836,-0.0399810310479138,-0.0331670830755910,-0.0259383876269583,-0.0183823562241159,-0.0105930248403432,-0.00266973892998433,0.00528427975073012,0.0131634632463974,0.0208615007038091,0.0282729890707696,0.0352951037366897,0.0418292604786285,0.0477827394132326,0.0530702415430203,0.0576153489474371,0.0613518607158085,0.0642249783487270,0.0661923165513562,0.0672247180781594,0.0673068545221657,0.0664375986190632,0.0646301576915694,0.0619119622166549,0.0583243080724040,0.0539217557205176,0.0487712943075182,0.0429512833223807,0.0365501889296935,0.0296651363062785,0.0224003031502281,0.0148651829156703,0.00717274917390284,-0.000562445257849687,-0.00822619920218492,-0.0157065879345257,-0.0228958457019882,-0.0296921703396657,-0.0360014157310745,-0.0417386399353258,-0.0468294795619122,-0.0512113243608670,-0.0548342699427938,-0.0576618309679033,-0.0596714019522614,-0.0608544579300839,-0.0612164924731504,-0.0607766958877554,-0.0595673816696802,-0.0576331743828892,-0.0550299769260233,-0.0518237395564768,-0.0480890569578212,-0.0439076229765390,-0.0393665753455129,-0.0345567646963899,-0.0295709833989691,-0.0245021902285466,-0.0194417665449494,-0.0144778385810278,-0.00969369861261408,-0.00516635526232342,-0.000965240037875716,0.00284890650198947,0.00622494973582647,0.00912206244707236,0.0115102029006691,0.0133703646125225,0.0146945978842527,0.0154858080844167,0.0157573403746075,0.0155323649986110,0.0148430812773304,0.0137297619941244,0.0122396628396920,0.0104258239519961,0.00834579228983120,0.00606029458985301,0.00363189096457440,0.00112363880847399,-0.00140220438676453,-0.00388541241045075,-0.00626893129492706,-0.00849990805732937,-0.0105305886618999,-0.0123190702404767,-0.0138298964626441,-0.0150344889585088,-0.0159114117646252,-0.0164464697861558,-0.0166326461479096,-0.0164698869508742,-0.0159647452744482,-0.0151298991927379,-0.0139835610425244,-0.0125487971403156,-0.0108527785598410,-0.00892598442775858,-0.00680137946766080,-0.00451358722910939,-0.00209807960237253,0.000409598122592683,0.00297454919345221,0.00556317906559756,0.00814376806509135,0.0106869530792006,0.0131661112535944,0.0155576417049808,0.0178411442882864,0.0199994974055143,0.0220188396302460,0.0238884624745415,0.0256006238788686,0.0271502939053347,0.0285348456155242,0.0297537051842311,0.0308079759195252,0.0317000510211180,0.0324332296190495,0.0330113499120828,0.0334384521004983,0.0337184823227251,0.0338550470104741,0.0338512250317497,0.0337094427605613,0.0334314148658752,0.0330181512221916,0.0324700279822264,0.0317869185888537,0.0309683784053635,0.0300138747712561,0.0289230526990970,0.0276960251615700,0.0263336760121564,0.0248379630624330,0.0232122087170927,0.0214613658461114,0.0195922472421106,0.0176137080488077,0.0155367719219145,0.0133746933557945,0.0111429505281578,0.00885916512472136,0.00654294784448489,0.00421567058896402,0.00190016863861442,-0.000379621649799074,-0.00259908199448794,-0.00473337865607892,-0.00675796503630914,-0.00864910786854246,-0.0103844234438338,-0.0119434096675980,-0.0133079594817290,-0.0144628413248562,-0.0153961328380000,-0.0160995949420202,-0.0165689746943027,-0.0168042269426200,-0.0168096466926547,-0.0165939062431272,-0.0161699934632628,-0.0155550500309818,-0.0147701109529711,-0.0138397491843881,-0.0127916315912516,-0.0116559947893908,-0.0104650514905267,-0.00925233983415186,-0.00805202973540718,-0.00689820149392180,-0.00582411275517227,-0.00486147037243979,-0.00403972377207610,-0.00338539607599488,-0.00292146849182356,-0.00266683236168612,-0.00263582179326076,-0.00283783801830658,-0.00327707457862716,-0.00395235017818420,-0.00485705361860038,-0.00597920271297988,-0.00730161651125852,-0.00880219763105523,-0.0104543190320079,-0.0122273072569751,-0.0140870120443408,-0.0159964503406513,-0.0179165111541073,-0.0198067064216595,-0.0216259521420131,-0.0233333634713009,-0.0248890472960159,-0.0262548759882900,-0.0273952266020628,-0.0282776706667837,-0.0288736009517142,-0.0291587830751315,-0.0291138215790437,-0.0287245320365453,-0.0279822128569198,-0.0268838126516705,-0.0254319912701818,-0.0236350748541117,-0.0215069074436476,-0.0190666037478085,-0.0163382096201347,-0.0133502785202386,-0.0101353737562660,-0.00672950756514758,-0.00317152907524811,0.000497526104510689,0.00423511152062640,0.00799785747799589,0.0117422575293745,0.0154253412215252,0.0190053211720474,0.0224422034822470,0.0256983516203834,0.0287389952026565,0.0315326765201482,0.0340516291708248,0.0362720847182220,0.0381745048745768,0.0397437382593081,0.0409691022794641,0.0418443920856748,0.0423678198475877,0.0425418887432814,0.0423732070489838,0.0418722485347252,0.0410530660095519,0.0399329653128972,0.0385321473177949,0.0368733256026179,0.0349813273709030,0.0328826849672996,0.0306052249685967,0.0281776613415029,0.0256291985745461,0.0229891500324482,0.0202865760703314,0.0175499457046388,0.0148068248892964,0.0120835937095690,0.00940519410044674,0.00679490903704983,0.00427417354454556,0.00186241734457588,-0.000423061498712049,-0.00256719294327084,-0.00455720264640539,-0.00638265246877455,-0.00803545545611617,-0.00950986701807360,-0.0108024540320775,-0.0119120435590997,-0.0128396527783756,-0.0135884016415728,-0.0141634096251266,-0.0145716778339758,-0.0148219575913387,-0.0149246065469321,-0.0148914332581660,-0.0147355311516156,-0.0144711027598374,-0.0141132751537180,-0.0136779075532938,-0.0131813921986410,-0.0126404496933581,-0.0120719201909883,-0.0114925519725775,-0.0109187891533510,-0.0103665604492406,-0.00985107112015556,-0.00938660037676838,-0.00898630668160787,-0.00866204348443294,-0.00842418799803042,-0.00828148563676935,-0.00824091270088804,-0.00830755979066852,-0.00848453827423250,-0.00877291191042902,-0.00917165544585239,-0.00967764166599767,-0.0102856579903053,-0.0109884532664008,-0.0117768149487037,-0.0126396763504845,-0.0135642531470788,-0.0145362077926358,-0.0155398400051573,-0.0165583009863156,-0.0175738285849718,-0.0185680001971445,-0.0195219998301938,-0.0204168954537789,-0.0212339225219342,-0.0219547693849982,-0.0225618602210566,-0.0230386311061399,-0.0233697949109755,-0.0235415908581620,-0.0235420147940068,-0.0233610265191806,-0.0229907308755393,-0.0224255296954844,-0.0216622421765690,-0.0207001917384045,-0.0195412579414770,-0.0181898925881158,-0.0166530996744580,-0.0149403794088976,-0.0130636370477258,-0.0110370578136248,-0.00887694964933366,-0.00660155601008659,-0.00423084130827623,-0.00178625198729749,0.000709543485124745,0.00323293215328810,0.00575964788257035,0.00826507253302769,0.0107245429927558,0.0131136600230140,0.0154085948754079,0.0175863896988061,0.0196252478572948,0.0215048104272019,0.0232064153277733,0.0247133357630857,0.0260109949089359,0.0270871540645220,0.0279320718016868,0.0285386319814127,0.0289024388654426,0.0290218779277541,0.0288981413636811,0.0285352177013034,0.0279398453378548,0.0271214302507420,0.0260919285655318,0.0248656950988856,0.0234592994294680,0.0218913114804883,0.0201820590194404,0.0183533598890100,0.0164282321727543,0.0144305858643367,0.0123848999437420,0.0103158890616521,0.00824816428751558,0.00620589258127044,0.00421245979680917,0.00229014211109313,0.000459790790860801,-0.00125946484558100,-0.00285049154468589,-0.00429839879483291,-0.00559075383661352,-0.00671776114788405,-0.00767240299246664,-0.00845053814286816,-0.00905095647770478,-0.00947538780646716,-0.00972846397889293,-0.00981763408293853,-0.00975303331206727,-0.00954730687589858,-0.00921539112373218,-0.00877425483283393,-0.00824260436694987,-0.00764055711949748,-0.00698928830472588,-0.00631065673393457,-0.00562681569871248,-0.00495981546661120,-0.00433120416594672,-0.00376163398683670,-0.00327047964876570,-0.00287547597713290,-0.00259238119131414,-0.00243467213654105,-0.00241327719602724,-0.00253635200576144,-0.00280910237249457,-0.00323365797849306,-0.00380899955976019,-0.00453094128480709,-0.00539216905750395,-0.00638233444012572,-0.00748820286228337,-0.00869385376918201,-0.00998092938957717,-0.0113289278902549,-0.0127155358490365,-0.0141169942397991,-0.0155084914963667,-0.0168645767205330,-0.0181595857333493,-0.0193680724456183,-0.0204652379475712,-0.0214273497900212,-0.0222321441476271,-0.0228592039138310,-0.0232903062679849,-0.0235097338667772,-0.0235045445303150,-0.0232647951019232,-0.0227837160418652,-0.0220578342493840,-0.0210870425744330,-0.0198746154595400,-0.0184271711228589,-0.0167545816356623,-0.0148698331424099,-0.0127888393017269,-0.0105302117766540,-0.00811499225914723,-0.00556635106627268,-0.00290925778581832,-0.000170129771944787,0.00262353550532216,0.00544353816895765,0.00826135764629390,0.0110485324690299,0.0137770324920457,0.0164196181969488,0.0189501821620076,0.0213440682626695,0.0235783647022102,0.0256321675457260,0.0274868120281486,0.0291260695140456,0.0305363085902594,0.0317066193595596,0.0326289005634934,0.0332979096861504,0.0337112766700806,0.0338694823055074,0.0337758027306177,0.0334362218024146,0.0328593133645973,0.0320560956531187,0.0310398602449568,0.0298259780759931,0.0284316851355143,0.0268758504942226,0.0251787293466340,0.0233617037542411,0.0214470137694551,0.0194574816081280,0.0174162315255474,0.0153464080412392,0.0132708951544499,0.0112120391961284,0.00919137797439699,0.00722937888718236,0.00534518869471022,0.00355639766143115,0.00187882078596758,0.000326298832235702,-0.00108947815226905,-0.00235912220154315,-0.00347567114348207,-0.00443468226126552,-0.00523429369375292,-0.00587525160949067,-0.00636090149372705,-0.00669714225519807,-0.00689234228978149,-0.00695721712967798,-0.00690466885554918,-0.00674958804868830,-0.00650861970217320,-0.00619989518320645,-0.00584273303060150,-0.00545731206697256,-0.00506432098851762,-0.00468458924917212,-0.00433870466254966,-0.00404662368652386,-0.00382728081395766,-0.00369820385225526,-0.00367514211881803,-0.00377171469577041,-0.00399908586452847,-0.00436567467078266,-0.00487690524832926,-0.00553500405447366,-0.00633884954271225,-0.00728387902616499,-0.00836205657770760,-0.00956190478362023,-0.0108686020340756,-0.0122641458164515,-0.0137275811996760,-0.0152352923854066,-0.0167613538824767,-0.0182779365636004,-0.0197557626172734,-0.0211646022424355,-0.0224738038772182,-0.0236528488328166,-0.0246719204437642,-0.0255024772682421,-0.0261178194945867,-0.0264936375468288,-0.0266085319423792,-0.0264444937434677,-0.0259873354601939,-0.0252270630014284,-0.0241581802195264,-0.0227799187401284,-0.0210963870887105,-0.0191166345962047,-0.0168546271582912,-0.0143291336050052,-0.0115635231747228,-0.00858547634322701,-0.00542661299730257,-0.00212204362593108,0.00129014920583455,0.00476949036975264,0.00827374263702865,0.0117595769356626,0.0151832703433440,0.0185014190875784,0.0216716534066483,0.0246533409687411,0.0274082656572546,0.0299012689072814,0.0321008414152096,0.0339796539282335,0.0355150169359914,0.0366892604101636,0.0374900262428549,0.0379104676902168,0.0379493519001300,0.0376110634555088,0.0369055087599246,0.0358479229909936,0.0344585832106335,0.0327624330120465,0.0307886257650636,0.0285699950606839,0.0261424623218804,0.0235443927144439,0.0208159114365874,0.0179981931717896,0.0151327379435907,0.0122606468067013,0.00942191074417787,0.00665472581918093,0.00399484706078877,0.00147499276016182,-0.000875690165721605,-0.00303209029824986,-0.00497351726532732,-0.00668400216922450,-0.00815250797772820,-0.00937304666568092,-0.0103447016396891,-0.0110715557330607,-0.0115625267877895,-0.0118311145136729,-0.0118950639012075,-0.0117759519368400,-0.0114987057013085,-0.0110910611022420,-0.0105829724824364,-0.0100059841406042,-0.00939257539110650,-0.00877549116642068,-0.00818707032802568,-0.00765858379905184,-0.00721959437020785,-0.00689734956743252,-0.00671621831691865,-0.00669718131501217,-0.00685738402393909,-0.00720976008844167,-0.00776273172406082,-0.00851999228716643,-0.00948037482303632,-0.0106378089249767,-0.0119813667484803,-0.0134953975333424,-0.0151597485165829,-0.0169500686921792,-0.0188381905111382,-0.0207925833370888,-0.0227788712965886,-0.0247604071061902,-0.0266988925346326,-0.0285550353809297,-0.0302892322281763,-0.0318622657769828,-0.0332360052777877,-0.0343740984718589,-0.0352426435183196,-0.0358108296284974,-0.0360515355465595,-0.0359418756017711,-0.0354636838056623,-0.0346039273675915,-0.0333550420432861,-0.0317151828995233,-0.0296883853588959,-0.0272846327644789,-0.0245198281564315,-0.0214156694608666,-0.0179994288341687,-0.0143036384606995,-0.0103656866450691,-0.00622732954788898,-0.00193412536197685,0.00246520090970796,0.00691945265611149,0.0113757062947845,0.0157800938221969,0.0200786109519215,0.0242179378987708,0.0281462594543694,0.0318140708027224,0.0351749555519801,0.0381863227160940,0.0408100898688856,0.0430133004106632,0.0447686638271957,0.0460550089716578,0.0468576417469713,0.0471686000895697,0.0469868008329312,0.0463180748335911,0.0451750886439096,0.0435771529820403,0.0415499202455715,0.0391249753048721,0.0363393257580743,0.0332347996945110,0.0298573607605523,0.0262563519157705,0.0224836806749618,0.0185929598224307,0.0146386185323322,0.0106749995102808,0.00675545816920783,0.00293147995424036,-0.000748168269442170,-0.00423823735588024,-0.00749773093667174,-0.0104905628782735,-0.0131861249746169,-0.0155597543129202,-0.0175930915684294,-0.0192743234843674,-0.0205983049388184,-0.0215665582493451,-0.0221871496749645,-0.0224744453980885,-0.0224487515598565,-0.0221358451348428,-0.0215664045205815,-0.0207753506410917,-0.0198011110821756,-0.0186848212542837,-0.0174694777856789,-0.0161990602594519,-0.0149176380037754,-0.0136684789132716,-0.0124931772150283,-0.0114308166970797,-0.0105171851985196,-0.00978405513401360,-0.00925854351295799,-0.00896256334247519,-0.00891237650673754,-0.00911825623027335,-0.00958426510116700,-0.0103081523954766,-0.0112813721526466,-0.0124892211498873,-0.0139110936578974,-0.0155208476761483,-0.0172872752862230,-0.0191746678662544,-0.0211434652141960,-0.0231509761636190,-0.0251521570687583,-0.0271004336056074,-0.0289485506968126,-0.0306494350274065,-0.0321570545771557,-0.0334272598482856,-0.0344185920034097,-0.0350930439308173,-0.0354167613009621,-0.0353606719426568,-0.0349010333199785,-0.0340198894981056,-0.0327054307129659,-0.0309522504691355,-0.0287614969458917,-0.0261409173561257,-0.0231047957415938,-0.0196737864673162,-0.0158746473670229,-0.0117398780627649,-0.00730727041119611,-0.00261937929659991,0.00227707691924417,0.00733187607917628,0.0124920011284694,0.0177023868057208,0.0229066923954202,0.0280480886946330,0.0330700474144413,0.0379171214782244,0.0425357050800421,0.0468747629119377,0.0508865186422612,0.0545270935106539,0.0577570867814191,0.0605420907480722,0.0628531339909695,0.0646670476410432,0.0659667504810286,0.0667414498077709,0.0669867560733852,0.0667047104089173,0.0659037252029281,0.0645984389517277,0.0628094876116608,0.0605631956617574,0.0578911910227960,0.0548299488724539,0.0514202702419573,0.0477067020736101,0.0437369061565161,0.0395609850348714,0.0352307735937864,0.0307991055652177,0.0263190646539012,0.0218432303519217,0.0174229287817816,0.0131074990720162,0.00894358581677425,0.00497446809163385,0.00123943528301754,-0.00222678037039172,-0.00539450513578520,-0.00823955032143470,-0.0107435560911623,-0.0128942456434924,-0.0146855839793207,-0.0161178367685966,-0.0171975262506359,-0.0179372826494782,-0.0183555912363226,-0.0184764369026808,-0.0183288498938415,-0.0179463581624430,-0.0173663536033046,-0.0166293811876482,-0.0157783616902236,-0.0148577602585087,-0.0139127144709418,-0.0129881367338741,-0.0121278068393557,-0.0113734712156953,-0.0107639658216282,-0.0103343797394322,-0.0101152762947928,-0.0101319879605006,-0.0104040003832428,-0.0109444396115653,-0.0117596750102687,-0.0128490484419092,-0.0142047381075828,-0.0158117630023801,-0.0176481312986629,-0.0196851331719668,-0.0218877756848371,-0.0242153544027027,-0.0266221534956968,-0.0290582632457090,-0.0314705011938451,-0.0338034206936607,-0.0360003884410386,-0.0380047106890998,-0.0397607863769510,-0.0412152643480089,-0.0423181812422074,-0.0430240565420607,-0.0432929216502853,-0.0430912607802045,-0.0423928428416480,-0.0411794253849258,-0.0394413139925740,-0.0371777632406862,-0.0343972084361421,-0.0311173207109418,-0.0273648816501067,-0.0231754773685531,-0.0185930157534875,-0.0136690743676450,-0.00846209017950839,-0.00303640576488774,0.00253881017166933,0.00819074725374419,0.0138442197330758,0.0194229895453680,0.0248511196135468,0.0300543300391174,0.0349613295669289,0.0395050950610407,0.0436240726874395,0.0472632760466964,0.0503752586058594,0.0529209404000042,0.0548702720534118,0.0562027226404210,0.0569075816889433,0.0569840696397012,0.0564412552197327,0.0552977823740439,0.0535814135273782,0.0513283999226617,0.0485826935106935,0.0453950182594967 }; //实向量[1, 1, 1, 1, 0, 0, 0, 0]
//存上面的 PPG 实数信号转成的复数形式
CPLX buf[COUNT];
double count = 4096;
double srate = 125;
//第一个数存心率值，第二个数存对应的位置
double Y_N_prev[2];
///////////////////////////////////////////////////////////////////////////////////////////////////
// bpmFft3 参数
double E[COUNT] = { 0.0426200317082125,0.0382177342338972,0.0300212546649654,0.0204599692264184,0.0107479145967055,0.00196697731947712,-0.00502771800731262,-0.00997002969213265,-0.0130632856062877,-0.0146102643357915,-0.0147980738446603,-0.0137269287534091,-0.0115449342085988,-0.00853467253524452,-0.00509515632438289,-0.00165497968787203,0.00141998491075858,0.00388346042094647,0.00562194464977785,0.00663586925075287,0.00700562412222910,0.00685607714467029,0.00632740897696985,0.00555498483358152,0.00465772099492460,0.00373291076702069,0.00285522422979971,0.00207800615159250,0.00143561696254930,0.000946122486279194,0.000614025387686294,0.000432937374047929,0.000388163031989800,0.000459164949215378,0.000621856255452533,0.000850651572434763,0.00112021178447492,0.00140683978315620,0.00168951478972954,0.00195058266850159,0.00217614203651302,0.00235617791705602,0.00248449657403274,0.00255850971206228,0.00257890710674064,0.00254924737807032,0.00247548943140112,0.00236548308447875,0.00222843633288944,0.00207437748330275,0.00191363158511287,0.00175633095033188,0.00161197826839086,0.00148907767374897,0.00139484440453273,0.00133499804581811,0.00145284253547005,0.00168206224253516,0.00196924798693606,0.00227051092389114,0.00256075230283720,0.00283678776691284,0.00311419765792865,0.00342085253343286,0.00379005412854685,0.00425517647509876,0.00484641100032702,0.00558927380370971,0.00650413796231172,0.00760609091420971,0.00890464974273210,0.0104031183966444,0.0120975667806871,0.0139755454761892,0.0160147369716257,0.0181817970109675,0.0204316604621515,0.0227075707777240,0.0249420365618408,0.0270588251576926,0.0289759828980913,0.0306097434594117,0.0318790699701832,0.0327104884925561,0.0330428170452911,0.0328313755256391,0.0320512765307727,0.0306994476580832,0.0287951284399456,0.0263787232501412,0.0235090679996527,0.0202593600684868,0.0167121717406968,0.0129540794776679,0.00907046841785351,0.00514100874666568,0.00123616610329753,-0.00258506421860977,-0.00627618202470914,-0.00980309043992077,-0.0131431058298385,-0.0162833305019392,-0.0192186494276211,-0.0219495835864748,-0.0244801895767739,-0.0268161494999866,-0.0289631540974152,-0.0309256486752151,-0.0327059851219168,-0.0343040018147049,-0.0357170330597255,-0.0369403277775899,-0.0379678315272197,-0.0387932568678930,-0.0394113373278498,-0.0398191351760538,-0.0400172594219434,-0.0400108539750419,-0.0398102396650451,-0.0394311361032830,-0.0388944434249236,-0.0382256196465520,-0.0374537360599802,-0.0366103226951639,-0.0357281249861174,-0.0348398828893598,-0.0339772200793254,-0.0331697003717834,-0.0324440777375247,-0.0318237400057252,-0.0313283272832236,-0.0309734949041997,-0.0307707866003894,-0.0307275849581598,-0.0308471112591383,-0.0311284537842794,-0.0315666112809267,-0.0321525457008649,-0.0328732450860222,-0.0337118034566897,-0.0346475296948243,-0.0356561016062976,-0.0367097843330732,-0.0377777336382290,-0.0388264037465210,-0.0398200758113820,-0.0407215162453422,-0.0414927639656367,-0.0420960324749219,-0.0424946977387734,-0.0426543279384321,-0.0425436989065666,-0.0421357321558816,-0.0414082932204465,-0.0403447977272983,-0.0389345906535443,-0.0371730881591140,-0.0350616972515588,-0.0326075517038151,-0.0298231189041885,-0.0267257388881168,-0.0233371529195503,-0.0196830659674235,-0.0157927682184562,-0.0116988192622336,-0.00743677878187090,-0.00304495290950332,0.00143588180742923,0.00596281370796735,0.0104912184868171,0.0149752819355994,0.0193686185060159,0.0236249644836982,0.0276989119231407,0.0315466433516198,0.0351266284792485,0.0384002519525247,0.0413323533363720,0.0438916739758331,0.0460512171297079,0.0477885354536681,0.0490859623917133,0.0499308014708146,0.0503154811530882,0.0502376747525636,0.0497003771487216,0.0487119245531522,0.0472859417217825,0.0454412032290349,0.0432014013040475,0.0405948210392736,0.0376539327371585,0.0344149188157364,0.0309171573779299,0.0272026852585126,0.0233156600043793,0.0193018336584541,0.0152080429706990,0.0110817126598397,0.00697036239857271,0.00292110558749220,-0.00101987075437969,-0.00480785083645952,-0.00840015821059122,-0.0117567373897519,-0.0148407316522986,-0.0176190344200620,-0.0200627896286752,-0.0221478182462122,-0.0238549531832501,-0.0251702722561435,-0.0260852271674302,-0.0265966741031684,-0.0267068172168001,-0.0264230792053916,-0.0257579132892070,-0.0247285687095314,-0.0233568183185962,-0.0216686530388636,-0.0196939448472290,-0.0174660780552440,-0.0150215481263600,-0.0123995278243382,-0.00964140161722192,-0.00679027041753706,-0.00389042949488923,-0.000986822558992835,0.00187552534367343,0.00465209403271017,0.00729947169669096,0.00977597340730687,0.0120422706809815,0.0140620250909272,0.0158025147166293,0.0172352373955400,0.0183364702505100,0.0190877619518155,0.0194763337364190,0.0194953681049900,0.0191441704863003,0.0184281983631425,0.0173589630144987,0.0159538192510532,0.0142356662813865,0.0122325864408421,0.00997744696517681,0.00750748330398362,0.00486387170160734,0.00209128589110182,-0.000762579690291900,-0.00364754702244446,-0.00651158250804431,-0.00930154290758785,-0.0119640551314185,-0.0144465281058888,-0.0166982731115477,-0.0186716867382365,-0.0203234321894633,-0.0216155441296920,-0.0225163824655140,-0.0230013722930154,-0.0230534892882294,-0.0226634784311173,-0.0218298240190034,-0.0205585149415346,-0.0188626664656315,-0.0167620654131460,-0.0142826990193356,-0.0114563106615276,-0.00832000161375101,-0.00491587166711562,-0.00129066773008323,0.00250460732645917,0.00641518024151633,0.0103831376659537,0.0143482364336406,0.0182489056641583,0.0220234248223336,0.0256112345986374,0.0289543155461695,0.0319985567306813,0.0346950353549893,0.0370011382703734,0.0388814750917243,0.0403085561958331,0.0412632323712279,0.0417349118560269,0.0417215818748413,0.0412296644850286,0.0402737315906554,0.0388760941332586,0.0370662694601835,0.0348803225015101,0.0323600736137719,0.0295521702069130,0.0265070301364767,0.0232776801238554,0.0199185287030379,0.0164841264599673,0.0130279731755565,0.00960142974799654,0.00625278211609702,0.00302648640280920,-3.73977281210773e-05,-0.00290360096193032,-0.00554189956571668,-0.00792727757337013,-0.0100400439193304,-0.0118659453984428,-0.0133963009696340,-0.0146281620339517,-0.0155644806571895,-0.0162142475025166,-0.0165925474973290,-0.0167204770183911,-0.0166248730279516,-0.0163378214330596,-0.0158959361644506,-0.0153394276464118,-0.0147110043256849,-0.0140546690890735,-0.0134144806258174,-0.0128333472221665,-0.0123519085830440,-0.0120075433586389,-0.0118335203260043,-0.0118582937249471,-0.0121049311474746,-0.0125906571461980,-0.0133264971827713,-0.0143170130527643,-0.0155601299223322,-0.0170470637183963,-0.0187623633043146,-0.0206840830136960,-0.0227840972799378,-0.0250285611006453,-0.0273785097064972,-0.0297905803587631,-0.0322178309182710,-0.0346106254068280,-0.0369175570666890,-0.0390863843224910,-0.0410649636083423,-0.0428021735814107,-0.0442488356204216,-0.0453586432085373,-0.0460891153217304,-0.0464025842381428,-0.0462672152834830,-0.0456580357054875,-0.0445579250892693,-0.0429584955714081,-0.0408607729924245,-0.0382755862437823,-0.0352235854807842,-0.0317348408289058,-0.0278480174015360,-0.0236091717289624,-0.0190702591885657,-0.0142874729098836,-0.00931954664140011,-0.00422614670922921,0.000933544714747968,0.00610198495785883,0.0112241295551168,0.0162479916999296,0.0211249278084095,0.0258096975743240,0.0302603654908586,0.0344381252004950,0.0383071371140668,0.0418344710243916,0.0449902357544671,0.0477479546787694,0.0500852088122950,0.0519845209426636,0.0534344015301670,0.0544304293089119,0.0549762072306688,0.0550840264907240,0.0547750923409091,0.0540792134618373,0.0530339237191688,0.0516830785737624,0.0500750344757041,0.0482605668602947,0.0462907044907662,0.0442146543288697,0.0420779662912715,0.0399210485296195,0.0377780992896944,0.0356764779030952,0.0336364999575476,0.0316716128967100,0.0297888890657957,0.0279897630477050,0.0262709376917056,0.0246253867600397,0.0230433897143045,0.0215135440305122,0.0200237110258148,0.0185618613434710,0.0171167952830658,0.0156787208676669,0.0142396791138157,0.0127938118953221,0.0113374736212466,0.00986919408385463,0.00838950634015382,0.00690066002184099,0.00540624632020161,0.00391076520334937,0.00241916744185929,0.000936403351052197,-0.000532993098482713,-0.00198526143129140,-0.00341769614879603,-0.00482884229505783,-0.00621860103437822,-0.00758824639789222,-0.00894035852871548,-0.0102786819998658,-0.0116079203205139,-0.0129334797587891,-0.0142611771216291,-0.0155969270037167,-0.0169464239922641,-0.0183148341266232,-0.0197065074117958,-0.0211247194475475,-0.0225714456191168,-0.0240471664382475,-0.0255506983591768,-0.0270790416111181,-0.0286272360396303,-0.0301882180567880,-0.0317526765012794,-0.0333089118881164,-0.0348427110687281,-0.0363372562947401,-0.0377730926134702,-0.0391281792238434,-0.0403780482332852,-0.0414960882249075,-0.0424539609257659,-0.0432221483832946,-0.0437706170305646,-0.0440695754440986,-0.0440902957131861,-0.0438059648050726,-0.0431925321077707,-0.0422295218410456,-0.0409007832425561,-0.0391951562730979,-0.0371070351641256,-0.0346368159805460,-0.0317912174754353,-0.0285834672033670,-0.0250333476039437,-0.0211670999311366,-0.0170171875653657,-0.0126219241341216,-0.00802497544030339,-0.00327474682121640,0.00157633126339245,0.00647260705462957,0.0113560901467472,0.0161674047959285,0.0208468077467150,0.0253352649971669,0.0295755800770244,0.0335135616329251,0.0370992104645928,0.0402878963767385,0.0430414846864141,0.0453293628123467,0.0471293111137285,0.0484281608944160,0.0492221875153631,0.0495171982226798,0.0493282918688457,0.0486792893886006,0.0476018570964809,0.0461343666506041,0.0443205531046491,0.0422080437525387,0.0398468343949964,0.0372877863237262,0.0345812078850231,0.0317755708682755,0.0289163964390487,0.0260453301111273,0.0231994121250780,0.0204105397311250,0.0177051116922131,0.0151038425739671,0.0126217342762015,0.0102681936631486,0.00804728686131782,0.00595812176267890,0.00399534978860525,0.00214977578681247,0.000409061274061073,-0.00124149828284096,-0.00281814599430768,-0.00433781342502603,-0.00581727752420130,-0.00727235456436012,-0.00871715937095979,-0.0101634548309671,-0.0116201122629171,-0.0130926982816967,-0.0145831987881201,-0.0160898859753943,-0.0176073298904707,-0.0191265520678709,-0.0206353149240704,-0.0221185368206738,-0.0235588189182516,-0.0249370662280994,-0.0262331818412729,-0.0274268104802868,-0.0284981056006052,-0.0294284935142703,-0.0302014085164515,-0.0308029746809413,-0.0312226125891474,-0.0314535523834568,-0.0314932377706069,-0.0313436085907656,-0.0310112521146422,-0.0305074153445419,-0.0298478725018824,-0.0290526439773001,-0.0281455657656540,-0.0271537122156193,-0.0261066800100195,-0.0250357475792664,-0.0239729312126261,-0.0229499662359896,-0.0219972478420728,-0.0211427705474413,-0.0204111070573448,-0.0198224661546297,-0.0193918651685304,-0.0191284461647737,-0.0190349571394535,-0.0191074112981526,-0.0193349300457022,-0.0196997694717779,-0.0201775263927588,-0.0207375184410586,-0.0213433328494728,-0.0219535396264680,-0.0225225656587414,-0.0230017257383771,-0.0233404035833093,-0.0234873699917628,-0.0233922163369390,-0.0230068703788079,-0.0222871492562328,-0.0211942934548117,-0.0196964176407953,-0.0177698113838590,-0.0154000261617925,-0.0125826948525655,-0.00932404526454056,-0.00564108824298283,-0.00156148100303744,0.00287691507851343,0.00762674821967561,0.0126321181407557,0.0178296992474846,0.0231500002567778,0.0285187217795340,0.0338581822702550,0.0390887922101326,0.0441305644916737,0.0489046541270069,0.0533349215393969,0.0573495104055639,0.0608824236047630,0.0638750703190585,0.0662777453472465,0.0680509902865867,0.0691667775793042,0.0696094544861268,0.0693763862560131,0.0684782466893593,0.0669389195210141,0.0647949941741872,0.0620948622710164,0.0588974442256407,0.0552705957145717,0.0512892597035315,0.0470334396881619,0.0425860735040365,0.0380308850129618,0.0334502844100165,0.0289233784342676,0.0245241410605573,0.0203197846997921,0.0163693624904812,0.0127226243531039,0.00941914305224797,0.00648772117331916,0.00394608510270942,0.00180086723855165,4.78723365548214e-05,-0.00132738207157597,-0.00234886778868731,-0.00304901401233280,-0.00346747143011630,-0.00364970846681645,-0.00364548076369686,-0.00350721854893268,-0.00328837858245277,-0.00304180780668986,-0.00281816479981387,-0.00266444277009795,-0.00262263432727616,-0.00272857377889007,-0.00301098735267449,-0.00349077563916546,-0.00418054577834638,-0.00508440360493404,-0.00619800829762610,-0.00750888429179197,-0.00899697761072471,-0.0106354366702003,-0.0123915913188595,-0.0142280986343161,-0.0161042199471170,-0.0179771907472739,-0.0198036434777078,-0.0215410426052381,-0.0231490916297595,-0.0245910727148454,-0.0258350813215284,-0.0268551205917614,-0.0276320233063069,-0.0281541731092009,-0.0284180014131323,-0.0284282419953035,-0.0281979317056171,-0.0277481527979085,-0.0271075199429024,-0.0263114227155253,-0.0254010419696257,-0.0244221657232882,-0.0234238367069127,-0.0224568693423455,-0.0215722784352219,-0.0208196651231425,-0.0202456075101207,-0.0198921038428308,-0.0197951149911406,-0.0199832503786420,-0.0204766374348764,-0.0212860092700701,-0.0224120388711093,-0.0238449410454274,-0.0255643560169984,-0.0275395214191270,-0.0297297327575990,-0.0320850863913578,-0.0345474936269516,-0.0370519493438682,-0.0395280331779025,-0.0419016151501303,-0.0440967303208114,-0.0460375784667062,-0.0476505953048601,-0.0488665323591115,-0.0496224746484174,-0.0498637207454063,-0.0495454501596604,-0.0486341097420524,-0.0471084643198282,-0.0449602763426316,-0.0421946030166391,-0.0388297242848601,-0.0348967375786348,-0.0304388720891101,-0.0255105836881952,-0.0201764901557896,-0.0145101952705802,-0.00859303153383996,-0.00251272826448910,0.00363801097077923,0.00976305523402093,0.0157645589229154,0.0215448766159055,0.0270086966351684,0.0320653768140551,0.0366314234704643,0.0406330092593754,0.0440083856696036,0.0467100199725041,0.0487062814165080,0.0499825210897544,0.0505414333419613,0.0504026484343918,0.0496015768403922,0.0481875941327860,0.0462217109853838,0.0437739075869152,0.0409203220979757,0.0377404697261472,0.0343146375719313,0.0307215581175078,0.0270364192969713,0.0233292287605104,0.0196635193739347,0.0160953646637948,0.0126726666864109,0.00943468239366210,0.00641176435640569,0.00362530356957813,0.00108787222478558,-0.00119642997913328,-0.00323142257996208,-0.00502808661810977,-0.00660361504499062,-0.00798029604567004,-0.00918426568068259,-0.0102441752137966,-0.0111898234564240,-0.0120508051292905,-0.0128552232621760,-0.0136285082677872,-0.0143923799125414,-0.0151639820322541,-0.0159552139901953,-0.0167722774254529,-0.0176154512579608,-0.0184791015853093,-0.0193519256363081,-0.0202174203631022,-0.0210545570185851,-0.0218386339672579,-0.0225422719730953,-0.0231365102764403,-0.0235919587829589,-0.0238799622520995,-0.0239737366475671,-0.0238494452882135,-0.0234871917975874,-0.0228719160230507,-0.0219941855857359,-0.0208508772146914,-0.0194457371367742,-0.0177897988140645,-0.0159016215764443,-0.0138072994519994,-0.0115401811625112,-0.00914024501625001,-0.00665308962404687,-0.00412853304275760,-0.00161885527251803,0.000823235198689876,0.00314678978774715,0.00530481552057817,0.00725632298014820,0.00896808448087171,0.0104159910939260,0.0115859392906984,0.0124742240201243,0.0130874576539112,0.0134420677348780,0.0135634476039028,0.0134848421326883,0.0132460475995524,0.0128919934430461,0.0124712581715484,0.0120345559504012,0.0116332174202510,0.0113176800445854,0.0111360003854298,0.0111324026637528,0.0113458834392905,0.0118088994668827,0.0125461729366942,0.0135736538633393,0.0148976823467020,0.0165143933576798,0.0184094036695123,0.0205578149085974,0.0229245588169805,0.0254651009032192,0.0281265066503601,0.0308488601110443,0.0335670078495850,0.0362125819048187,0.0387162344273112,0.0410099952906406,0.0430296444340608,0.0447169757446048,0.0460218220943432,0.0469037148235634,0.0473330679206612,0.0472918083254759,0.0467734178514880,0.0457824051596379,0.0443332814716112,0.0424491631438501,0.0401601596753920,0.0375017208013820,0.0345131078832825,0.0312361236718428,0.0277141852987511,0.0239917654826496,0.0201141653039062,0.0161275274501768,0.0120789593764072,0.00801661717312044,0.00398960626958168,4.75844543611423e-05,-0.00375999735712136,-0.00738501757867327,-0.0107821032701226,-0.0139102204859117,-0.0167342694456205,-0.0192265053706678,-0.0213676235683976,-0.0231473927002491,-0.0245647841406033,-0.0256276149787315,-0.0263517837667139,-0.0267602202269557,-0.0268816863422782,-0.0267495560124705,-0.0264006686596120,-0.0258743074974459,-0.0252113059939541,-0.0244532462092748,-0.0236416878079383,-0.0228173608206206,-0.0220192688261569,-0.0212836782776243,-0.0206430070250498,-0.0201246616260279,-0.0197498999010321,-0.0195328060068484,-0.0194794581510184,-0.0195873473488789,-0.0198450773143985,-0.0202323509317211,-0.0207202369936916,-0.0212717168663867,-0.0218425326102285,-0.0223823868097955,-0.0228365652957853,-0.0231480505785453,-0.0232601531197613,-0.0231196058406255,-0.0226799546557455,-0.0219049592091769,-0.0207716282374186,-0.0192724876024295,-0.0174167371869310,-0.0152300931175976,-0.0127533060941429,-0.0100395491988500,-0.00715103113234607,-0.00415527809939598,-0.00112152686890922,0.00188240675089535,0.00479254921374101,0.00755039384247129,0.0101037804602258,0.0124071891496481,0.0144216727480098,0.0161146732474747,0.0174599453694093,0.0184377522921013,0.0190354127463099,0.0192481774636829,0.0190803117482648,0.0185461779794114,0.0176710654527003,0.0164915188674975,0.0150549749236609,0.0134186195595151,0.0116475042597290,0.00981207911385437,0.00798538479852744,0.00624017739182143,0.00464623622435576,0.00326803811418602,0.00216289326625947,0.00137955277717852,0.000957234071571025,0.000924978719709528,0.00130125731048530,0.00209376103171060,0.00329935750572508,0.00490422628855515,0.00688421604229187,0.00920547331191614,0.0118253796736623,0.0146938026591434,0.0177546237315775,0.0209474639296564,0.0242094951556276,0.0274772107077508,0.0306880363972846,0.0337816920239474,0.0367012559580013,0.0393939339581076,0.0418115773694770,0.0439110272853260,0.0456543749618947,0.0470092232312523,0.0479490107488337,0.0484534252595599,0.0485088901590465,0.0481090679887697,0.0472552928221386,0.0459568275890578,0.0442308469349542,0.0421020724280218,0.0396020315572562,0.0367679671931535,0.0336414789031784,0.0302670198618178,0.0266903936376001,0.0229573896160099,0.0191126663807823,0.0151989468204001,0.0112565379849494,0.00732314358759889,0.00343390530565028,-0.000378406140592525,-0.00408312920129923,-0.00765144769437525,-0.0110561787926600,-0.0142716523092557,-0.0172737098812325,-0.0200398450969008,-0.0225494989591820,-0.0247845156749079,-0.0267297483775861,-0.0283737818000151,-0.0297097109634692,-0.0307358867954064,-0.0314565188501325,-0.0318820202020194,-0.0320289963092832,-0.0319198197154104,-0.0315817908908709,-0.0310459509474994,-0.0303456690874226,-0.0295151617061251,-0.0285881017477752,-0.0275964457958931,-0.0265695513119274,-0.0255335925688796,-0.0245112277170413,-0.0235214341548296,-0.0225794215876431,-0.0216965514749087,-0.0208802319902078,-0.0201338095779780,-0.0194565302551400,-0.0188436837341705,-0.0182870589998358,-0.0177758204942755,-0.0172978535960854,-0.0168415298781426,-0.0163977232551110,-0.0159617977981455,-0.0155352240942764,-0.0151264947304670,-0.0147511103349473,-0.0144305747404596,-0.0141905247005757,-0.0140582717622319,-0.0140601110278404,-0.0142187418897962,-0.0145510668081973,-0.0150665210689579,-0.0157659768164351,-0.0166411864741812,-0.0176746970390951,-0.0188401764058434,-0.0201031335981391,-0.0214220669138432,-0.0227501135947158,-0.0240372769792430,-0.0252332523447692,-0.0262907545382974,-0.0271690860411971,-0.0278375182877862,-0.0282779568512713,-0.0284863835388878,-0.0284727401582365,-0.0282592058535337,-0.0278771363642895 };
double Y0 = 76.904296875000000;
double N_prev = 43;
//第一个数存心率值，第二个数存对应的位置
double BPM_N_prev[2];

int main()
{   /*************************************  初始心率估计  *********************************************/
    //初始心率估计
    //initial_estimate(buf, PPG_final, COUNT, srate, Y_N_prev);
    ////输出心率对应的位置
    //printf("%f\n", Y_N_prev[1]);
    ////输出心率值
    //printf("%f\n", Y_N_prev[0]);
    ///*************************************************************************************************/
    ///**************************************  数据预处理  *********************************************/
    //data_preprocess(buf, PPG1, srate);
    ///*************************************************************************************************/
    /****************************************  bpmFft3  **********************************************/
    bpmFft3(E, Y0, srate, N_prev, BPM_N_prev);
    //输出心率对应的位置
    printf("%f\n", BPM_N_prev[1]);
    //输出心率值
    printf("%f\n", BPM_N_prev[0]);
    /*************************************************************************************************/
   
    return 0;
}